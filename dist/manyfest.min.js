!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Fable=e()}}((function(){return function e(t,s,r){function a(n,o){if(!s[n]){if(!t[n]){var h="function"==typeof require&&require;if(!o&&h)return h(n,!0);if(i)return i(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var p=s[n]={exports:{}};t[n][0].call(p.exports,(function(e){return a(t[n][1][e]||e)}),p,p.exports,e,t,s,r)}return s[n].exports}for(var i="function"==typeof require&&require,n=0;n<r.length;n++)a(r[n]);return a}({1:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
var r=e("./Manyfest.js");"object"==typeof window&&(window.Manyfest=r),t.exports=r},{"./Manyfest.js":6}],2:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r,this.translationTable={}}translationCount(){return Object.keys(this.translationTable).length}addTranslation(e){if("object"!=typeof e)return this.logError("Hash translation addTranslation expected a translation be type object but was passed in "+typeof e),!1;Object.keys(e).forEach((t=>{"string"!=typeof e[t]?this.logError(`Hash translation addTranslation expected a translation destination hash for [${t}] to be a string but the referrant was a ${typeof e[t]}`):this.translationTable[t]=e[t]}))}removeTranslationHash(e){this.translationTable.hasOwnProperty(e)&&delete this.translationTable[e]}removeTranslation(e){if("string"==typeof e)return this.removeTranslationHash(e),!0;if("object"==typeof e){return Object.keys(e).forEach((e=>{this.removeTranslation(e)})),!0}return this.logError("Hash translation removeTranslation expected either a string or an object but the passed-in translation was type "+typeof e),!1}clearTranslations(){this.translationTable={}}translate(e){return this.translationTable.hasOwnProperty(e)?this.translationTable[e]:e}}},{"./Manyfest-LogToConsole.js":3}],3:[function(e,t,s){t.exports=(e,t)=>{let s="string"==typeof e?e:"";console.log(`[Manyfest] ${s}`),t&&console.log(JSON.stringify(t))}},{}],4:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r}cleanWrapCharacters(e,t){return t.startsWith(e)&&t.endsWith(e)?t.substring(1,t.length-1):t}checkAddressExists(e,t){if("object"!=typeof e)return!1;if("string"!=typeof t)return!1;let s=t.indexOf(".");if(-1==s){let s=t.indexOf("["),r=t.indexOf("]");if(s>0&&r>s&&r-s>0){let a=t.substring(0,s).trim();if("object"!=typeof e[a])return!1;let i=t.substring(s+1,r).trim(),n=parseInt(i,10);return Array.isArray(e[a])!=isNaN(n)&&(isNaN(n)?(i=this.cleanWrapCharacters('"',i),i=this.cleanWrapCharacters("`",i),i=this.cleanWrapCharacters("'",i),e[a].hasOwnProperty(i)):n in e[a])}return e.hasOwnProperty(t)}{let r=t.substring(0,s),a=t.substring(s+1),i=r.indexOf("["),n=r.indexOf("]");if(i>0&&n>i&&n-i>0){let t=r.substring(0,i).trim(),s=r.substring(i+1,n).trim(),o=parseInt(s,10);return Array.isArray(e[t])!=isNaN(o)&&(isNaN(o)?(s=this.cleanWrapCharacters('"',s),s=this.cleanWrapCharacters("`",s),s=this.cleanWrapCharacters("'",s),this.checkAddressExists(e[t][s],a)):this.checkAddressExists(e[t][o],a))}return(!e.hasOwnProperty(r)||"object"==typeof e[r])&&(e.hasOwnProperty(r)||(e[r]={}),this.checkAddressExists(e[r],a))}}getValueAtAddress(e,t){if("object"!=typeof e)return;if("string"!=typeof t)return;let s=t.indexOf(".");if(-1==s){let s=t.indexOf("["),r=t.indexOf("]");if(s>0&&r>s&&r-s>0){let a=t.substring(0,s).trim();if("object"!=typeof e[a])return;let i=t.substring(s+1,r).trim(),n=parseInt(i,10);if(Array.isArray(e[a])==isNaN(n))return;return isNaN(n)?(i=this.cleanWrapCharacters('"',i),i=this.cleanWrapCharacters("`",i),i=this.cleanWrapCharacters("'",i),e[a][i]):e[a][n]}return e[t]}{let r=t.substring(0,s),a=t.substring(s+1),i=r.indexOf("["),n=r.indexOf("]");if(i>0&&n>i&&n-i>0){let t=r.substring(0,i).trim(),s=r.substring(i+1,n).trim(),o=parseInt(s,10);if(Array.isArray(e[t])==isNaN(o))return;return isNaN(o)?(s=this.cleanWrapCharacters('"',s),s=this.cleanWrapCharacters("`",s),s=this.cleanWrapCharacters("'",s),this.getValueAtAddress(e[t][s],a)):this.getValueAtAddress(e[t][o],a)}return e.hasOwnProperty(r)&&"object"!=typeof e[r]?void 0:(e.hasOwnProperty(r)||(e[r]={}),this.getValueAtAddress(e[r],a))}}setValueAtAddress(e,t,s){if("object"!=typeof e)return!1;if("string"!=typeof t)return!1;let r=t.indexOf(".");if(-1==r){let r=t.indexOf("["),a=t.indexOf("]");if(r>0&&a>r&&a-r>0){let i=t.substring(0,r).trim();if("object"!=typeof e[i])return!1;let n=t.substring(r+1,a).trim(),o=parseInt(n,10);return Array.isArray(e[i])!=isNaN(o)&&(isNaN(o)?(n=this.cleanWrapCharacters('"',n),n=this.cleanWrapCharacters("`",n),n=this.cleanWrapCharacters("'",n),e[i][n]=s,!0):(e[i][o]=s,!0))}return e[t]=s,!0}{let a=t.substring(0,r),i=t.substring(r+1),n=a.indexOf("["),o=a.indexOf("]");if(n>0&&o>n&&o-n>0){let t=a.substring(0,n).trim(),r=a.substring(n+1,o).trim(),h=parseInt(r,10);return Array.isArray(e[t])!=isNaN(h)&&(isNaN(h)?(r=this.cleanWrapCharacters('"',r),r=this.cleanWrapCharacters("`",r),r=this.cleanWrapCharacters("'",r),this.setValueAtAddress(e[t][r],i,s)):this.setValueAtAddress(e[t][h],i,s))}return e.hasOwnProperty(a)&&"object"!=typeof e[a]?(e.hasOwnProperty("__ERROR")||(e.__ERROR={}),e.__ERROR[t]=s,!1):(e.hasOwnProperty(a)||(e[a]={}),this.setValueAtAddress(e[a],i,s))}}}},{"./Manyfest-LogToConsole.js":3}],5:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r}resolveAddressMappings(e,t){if("object"!=typeof e)return this.logError("Attempted to resolve address mapping but the descriptor was not an object."),!1;if("object"!=typeof t)return!0;let s=Object.keys(e),r={};return s.forEach((t=>{e[t].hasOwnProperty("Hash")&&(r[e[t].Hash]=t)})),Object.keys(t).forEach((s=>{let a=t[s],i=!1,n=!1;e.hasOwnProperty(s)?i=s:r.hasOwnProperty(s)&&(i=r[s]),i?(n=e[i],delete e[i]):n={Hash:s},e[a]=n})),!0}safeResolveAddressMappings(e,t){let s=JSON.parse(JSON.stringify(e));return this.resolveAddressMappings(s,t),s}}},{"./Manyfest-LogToConsole.js":3}],6:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js"),a=e("./Manyfest-ObjectAddressResolver.js"),i=e("./Manyfest-HashTranslation.js"),n=e("./Manyfest-SchemaManipulation.js");t.exports=class{constructor(e,t,s,o){this.logInfo="function"==typeof t?t:r,this.logError="function"==typeof s?s:r,this.objectAddressResolver=new a(this.logInfo,this.logError),this.options={strict:!1,defaultValues:{String:"",Number:0,Float:0,Integer:0,Boolean:!1,Binary:0,DateTime:0,Array:[],Object:{},Null:null}},this.scope=void 0,this.elementAddresses=void 0,this.elementHashes=void 0,this.elementDescriptors=void 0,this.reset(),"object"==typeof e&&this.loadManifest(e),this.schemaManipulations=new n(this.logInfo,this.logError),this.hashTranslations=new i(this.logInfo,this.logError)}reset(){this.scope="DEFAULT",this.elementAddresses=[],this.elementHashes={},this.elementDescriptors={}}deserialize(e){return this.loadManifest(JSON.parse(e))}loadManifest(e){if("object"!=typeof e)return this.logError(`(${this.scope}) Error loading manifest; expecting an object but parameter was type ${typeof e}.`),!1;if(e.hasOwnProperty("Scope")?"string"==typeof e.Scope?this.scope=e.Scope:this.logError(`(${this.scope}) Error loading scope from manifest; expecting a string but property was type ${typeof e.Scope}.`,e):this.logError(`(${this.scope}) Error loading scope from manifest object.  Property "Scope" does not exist in the root of the object.`,e),e.hasOwnProperty("Descriptors"))if("object"==typeof e.Descriptors){let t=Object.keys(e.Descriptors);for(let s=0;s<t.length;s++)this.addDescriptor(t[s],e.Descriptors[t[s]])}else this.logError(`(${this.scope}) Error loading description object from manifest object.  Expecting an object in 'Manifest.Descriptors' but the property was type ${typeof e.Descriptors}.`,e);else this.logError(`(${this.scope}) Error loading object description from manifest object.  Property "Descriptors" does not exist in the root of the Manifest object.`,e)}serialize(){return JSON.stringify(this.getManifest())}getManifest(){this.scope,JSON.parse(JSON.stringify(this.elementDescriptors))}addDescriptor(e,t){return"object"==typeof t?(t.hasOwnProperty("Address")||(t.Address=e),this.elementDescriptors.hasOwnProperty(e)||this.elementAddresses.push(e),this.elementDescriptors[e]=t,this.elementHashes[e]=e,t.hasOwnProperty("Hash")?this.elementHashes[t.Hash]=e:t.Hash=e,!0):(this.logError(`(${this.scope}) Error loading object descriptor for address '${e}' from manifest object.  Expecting an object but property was type ${typeof t}.`),!1)}getDescriptorByHash(e){return this.elementHashes.hasOwnProperty(e)||this.hashTranslations.translationTable.hasOwnProperty(e)?this.getDescriptor(this.elementHashes[this.hashTranslations.translate(e)]):void this.logError(`(${this.scope}) Error in getDescriptorByHash; the Hash ${e} doesn't exist in the schema.`)}getDescriptor(e){return this.elementDescriptors[e]}checkAddressExistsByHash(e,t){return this.elementHashes.hasOwnProperty(t)||this.hashTranslations.translationTable.hasOwnProperty(t)?this.checkAddressExists(e,this.elementHashes[this.hashTranslations.translate(t)]):void this.logError(`(${this.scope}) Error in checkAddressExistsByHash; the Hash ${t} doesn't exist in the schema.`)}checkAddressExists(e,t){return this.objectAddressResolver.checkAddressExists(e,t)}getValueByHash(e,t){return this.elementHashes.hasOwnProperty(t)||this.hashTranslations.translationTable.hasOwnProperty(t)?this.getValueAtAddress(e,this.elementHashes[this.hashTranslations.translate(t)]):void this.logError(`(${this.scope}) Error in getValueByHash; the Hash ${t} doesn't exist in the schema.`)}getValueAtAddress(e,t){return this.objectAddressResolver.getValueAtAddress(e,t)}setValueByHash(e,t,s){return this.elementHashes.hasOwnProperty(t)||this.hashTranslations.translationTable.hasOwnProperty(t)?this.setValueAtAddress(e,this.elementHashes[this.hashTranslations.translate(t)],s):void this.logError(`(${this.scope}) Error in setValueByHash; the Hash ${t} doesn't exist in the schema.  Value ${s} will not be written!`)}setValueAtAddress(e,t,s){return this.objectAddressResolver.setValueAtAddress(e,t,s)}validate(e){let t={Error:null,Errors:[],MissingElements:[]};"object"!=typeof e&&(t.Error=!0,t.Errors.push("Expected passed in object to be type object but was passed in "+typeof e));let s=(e,s)=>{t.Error=!0,t.Errors.push(`Element at address "${e}" ${s}.`)};for(let r=0;r<this.elementAddresses.length;r++){let a=this.getDescriptor(this.elementAddresses[r]),i=this.getValueAtAddress(e,a.Address);if(void 0===i&&(t.MissingElements.push(a.Address),(a.Required||this.options.strict)&&s(a.Address,"is flagged REQUIRED but is not set in the object")),a.DataType){let e=typeof i;switch(a.DataType.toString().trim().toLowerCase()){case"string":"string"!=e&&s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);break;case"number":"number"!=e&&s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);break;case"integer":if("number"!=e)s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);else{i.toString().indexOf(".")>-1&&s(a.Address,`has a DataType ${a.DataType} but has a decimal point in the number.`)}break;case"float":"number"!=e&&s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);break;case"DateTime":"Invalid Date"==new Date(i).toString()&&s(a.Address,`has a DataType ${a.DataType} but is not parsable as a Date by Javascript`);default:"string"!=e&&s(a.Address,`has a DataType ${a.DataType} (which auto-converted to String because it was unrecognized) but is of the type ${e}`)}}}return t}getDefaultValue(e){if(e.hasOwnProperty("Default"))return e.Default;{let t=e.hasOwnProperty("DataType")?e.DataType:"String";return this.options.defaultValues.hasOwnProperty(t)?this.options.defaultValues[t]:null}}populateDefaults(e,t){return this.populateObject(e,t,(e=>e.hasOwnProperty("Default")))}populateObject(e,t,s){let r="object"==typeof e?e:{},a=void 0!==t&&t,i="function"==typeof s?s:e=>!0;return this.elementAddresses.forEach((e=>{let t=this.getDescriptor(e);i(t)&&(!a&&this.checkAddressExists(r,e)||this.setValueAtAddress(r,e,this.getDefaultValue(t)))})),r}}},{"./Manyfest-HashTranslation.js":2,"./Manyfest-LogToConsole.js":3,"./Manyfest-ObjectAddressResolver.js":4,"./Manyfest-SchemaManipulation.js":5}]},{},[1])(1)}));
//# sourceMappingURL=manyfest.min.js.map
