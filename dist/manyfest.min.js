!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Fable=e()}}((function(){return function e(t,s,r){function i(o,n){if(!s[o]){if(!t[o]){var h="function"==typeof require&&require;if(!n&&h)return h(o,!0);if(a)return a(o,!0);var p=new Error("Cannot find module '"+o+"'");throw p.code="MODULE_NOT_FOUND",p}var l=s[o]={exports:{}};t[o][0].call(l.exports,(function(e){return i(t[o][1][e]||e)}),l,l.exports,e,t,s,r)}return s[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
var r=e("./Manyfest.js");"object"==typeof window&&(window.Manyfest=r),t.exports=r},{"./Manyfest.js":4}],2:[function(e,t,s){t.exports=(e,t)=>{let s="string"==typeof e?e:"";console.log(`[Manyfest] ${s}`),t&&console.log(JSON.stringify(t))}},{}],3:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r}cleanWrapCharacters(e,t){return t.startsWith(e)&&t.endsWith(e)?t.substring(1,t.length-1):t}checkAddressExists(e,t){let s=t.indexOf(".");if(-1===s){let s=t.indexOf("["),r=t.indexOf("]");if(s>0&&r>s&&r-s>0){let i=t.substring(0,s).trim();if("object"!=typeof e[i])return!1;let a=t.substring(s+1,r).trim(),o=parseInt(a,10);return Array.isArray(e[i])!=isNaN(o)&&(isNaN(o)?(a=this.cleanWrapCharacters('"',a),a=this.cleanWrapCharacters("`",a),a=this.cleanWrapCharacters("'",a),e[i].hasOwnProperty(a)):o in e[i])}return e.hasOwnProperty(t)}{let r=t.substring(0,s),i=t.substring(s+1),a=r.indexOf("["),o=r.indexOf("]");if(a>0&&o>a&&o-a>0){let t=r.substring(0,a).trim(),s=r.substring(a+1,o).trim(),n=parseInt(s,10);return Array.isArray(e[t])!=isNaN(n)&&(isNaN(n)?(s=this.cleanWrapCharacters('"',s),s=this.cleanWrapCharacters("`",s),s=this.cleanWrapCharacters("'",s),this.checkAddressExists(e[t][s],i)):this.checkAddressExists(e[t][n],i))}return(!e.hasOwnProperty(r)||"object"==typeof e[r])&&(e.hasOwnProperty(r)||(e[r]={}),this.checkAddressExists(e[r],i))}}getValueAtAddress(e,t){let s=t.indexOf(".");if(-1===s){let s=t.indexOf("["),r=t.indexOf("]");if(s>0&&r>s&&r-s>0){let i=t.substring(0,s).trim();if("object"!=typeof e[i])return;let a=t.substring(s+1,r).trim(),o=parseInt(a,10);if(Array.isArray(e[i])==isNaN(o))return;return isNaN(o)?(a=this.cleanWrapCharacters('"',a),a=this.cleanWrapCharacters("`",a),a=this.cleanWrapCharacters("'",a),e[i][a]):e[i][o]}return e[t]}{let r=t.substring(0,s),i=t.substring(s+1),a=r.indexOf("["),o=r.indexOf("]");if(a>0&&o>a&&o-a>0){let t=r.substring(0,a).trim(),s=r.substring(a+1,o).trim(),n=parseInt(s,10);if(Array.isArray(e[t])==isNaN(n))return;return isNaN(n)?(s=this.cleanWrapCharacters('"',s),s=this.cleanWrapCharacters("`",s),s=this.cleanWrapCharacters("'",s),this.getValueAtAddress(e[t][s],i)):this.getValueAtAddress(e[t][n],i)}return e.hasOwnProperty(r)&&"object"!=typeof e[r]?void 0:(e.hasOwnProperty(r)||(e[r]={}),this.getValueAtAddress(e[r],i))}}setValueAtAddress(e,t,s){let r=t.indexOf(".");if(-1===r){let r=t.indexOf("["),i=t.indexOf("]");if(r>0&&i>r&&i-r>0){let a=t.substring(0,r).trim();if("object"!=typeof e[a])return!1;let o=t.substring(r+1,i).trim(),n=parseInt(o,10);return Array.isArray(e[a])!=isNaN(n)&&(isNaN(n)?(o=this.cleanWrapCharacters('"',o),o=this.cleanWrapCharacters("`",o),o=this.cleanWrapCharacters("'",o),e[a][o]=s,!0):(e[a][n]=s,!0))}return e[t]=s,!0}{let i=t.substring(0,r),a=t.substring(r+1),o=i.indexOf("["),n=i.indexOf("]");if(o>0&&n>o&&n-o>0){let t=i.substring(0,o).trim(),r=i.substring(o+1,n).trim(),h=parseInt(r,10);return Array.isArray(e[t])!=isNaN(h)&&(isNaN(h)?(r=this.cleanWrapCharacters('"',r),r=this.cleanWrapCharacters("`",r),r=this.cleanWrapCharacters("'",r),this.setValueAtAddress(e[t][r],a,s)):this.setValueAtAddress(e[t][h],a,s))}return e.hasOwnProperty(i)&&"object"!=typeof e[i]?(e.hasOwnProperty("__ERROR")||(e.__ERROR={}),e.__ERROR[t]=s,!1):(e.hasOwnProperty(i)||(e[i]={}),this.setValueAtAddress(e[i],a,s))}}}},{"./Manyfest-LogToConsole.js":2}],4:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js"),i=e("./Manyfest-ObjectAddressResolver.js");t.exports=class{constructor(e,t,s,a){this.logInfo="function"==typeof t?t:r,this.logError="function"==typeof s?s:r,this.objectAddressResolver=new i(this.logInfo,this.logError),this.options={strict:!1,defaultValues:{String:"",Number:0,Float:0,Integer:0,Boolean:!1,Binary:0,DateTime:0,Array:[],Object:{},Null:null}},this.scope=void 0,this.elementAddresses=void 0,this.elementHashes=void 0,this.elementDescriptors=void 0,this.reset(),"object"==typeof e&&this.loadManifest(e)}reset(){this.scope="DEFAULT",this.elementAddresses=[],this.elementHashes={},this.elementDescriptors={}}deserialize(e){return this.loadManifest(JSON.parse(e))}loadManifest(e){if("object"!=typeof e)return this.logError(`(${this.scope}) Error loading manifest; expecting an object but parameter was type ${typeof e}.`),!1;if(e.hasOwnProperty("Scope")?"string"==typeof e.Scope?this.scope=e.Scope:this.logError(`(${this.scope}) Error loading scope from manifest; expecting a string but property was type ${typeof e.Scope}.`,e):this.logError(`(${this.scope}) Error loading scope from manifest object.  Property "Scope" does not exist in the root of the object.`,e),e.hasOwnProperty("Descriptors"))if("object"==typeof e.Descriptors){let t=Object.keys(e.Descriptors);for(let s=0;s<t.length;s++)this.addDescriptor(t[s],e.Descriptors[t[s]])}else this.logError(`(${this.scope}) Error loading description object from manifest object.  Expecting an object in 'Manifest.Descriptors' but the property was type ${typeof e.Descriptors}.`,e);else this.logError(`(${this.scope}) Error loading object description from manifest object.  Property "Descriptors" does not exist in the root of the Manifest object.`,e)}serialize(){return JSON.stringify(this.getManifest())}getManifest(){this.scope,JSON.parse(JSON.stringify(this.elementDescriptors))}addDescriptor(e,t){return"object"==typeof t?(t.hasOwnProperty("Address")||(t.Address=e),this.elementDescriptors.hasOwnProperty(e)||this.elementAddresses.push(e),this.elementDescriptors[e]=t,this.elementHashes[e]=e,t.hasOwnProperty("Hash")&&(this.elementHashes[t.Hash]=e),!0):(this.logError(`(${this.scope}) Error loading object descriptor for address '${e}' from manifest object.  Expecting an object but property was type ${typeof t}.`),!1)}getDescriptorByHash(e){return this.elementHashes.hasOwnProperty(e)?this.getDescriptor(this.elementHashes[e]):void this.logError(`(${this.scope}) Error in getDescriptorByHash; the Hash ${e} doesn't exist in the schema.`)}getDescriptor(e){return this.elementDescriptors[e]}checkAddressExistsByHash(e,t){return this.elementHashes.hasOwnProperty(t)?this.checkAddressExists(e,this.elementHashes[t]):void this.logError(`(${this.scope}) Error in checkAddressExistsByHash; the Hash ${t} doesn't exist in the schema.`)}checkAddressExists(e,t){return this.objectAddressResolver.checkAddressExists(e,t)}getValueByHash(e,t){return this.elementHashes.hasOwnProperty(t)?this.getValueAtAddress(e,this.elementHashes[t]):void this.logError(`(${this.scope}) Error in getValueByHash; the Hash ${t} doesn't exist in the schema.`)}getValueAtAddress(e,t){return this.objectAddressResolver.getValueAtAddress(e,t)}setValueByHash(e,t,s){return this.elementHashes.hasOwnProperty(t)?this.setValueAtAddress(e,this.elementHashes[t],s):void this.logError(`(${this.scope}) Error in setValueByHash; the Hash ${t} doesn't exist in the schema.  Value ${s} will not be written!`)}setValueAtAddress(e,t,s){return this.objectAddressResolver.setValueAtAddress(e,t,s)}validate(e){let t={Error:null,Errors:[],MissingElements:[]};"object"!=typeof e&&(t.Error=!0,t.Errors.push("Expected passed in object to be type object but was passed in "+typeof e));let s=(e,s)=>{t.Error=!0,t.Errors.push(`Element at address "${e}" ${s}.`)};for(let r=0;r<this.elementAddresses.length;r++){let i=this.getDescriptor(this.elementAddresses[r]),a=this.getValueAtAddress(e,i.Address);if(void 0===a&&(t.MissingElements.push(i.Address),(i.Required||this.options.strict)&&s(i.Address,"is flagged REQUIRED but is not set in the object")),i.DataType){let e=typeof a;switch(i.DataType.toString().trim().toLowerCase()){case"string":"string"!=e&&s(i.Address,`has a DataType ${i.DataType} but is of the type ${e}`);break;case"number":"number"!=e&&s(i.Address,`has a DataType ${i.DataType} but is of the type ${e}`);break;case"integer":if("number"!=e)s(i.Address,`has a DataType ${i.DataType} but is of the type ${e}`);else{a.toString().indexOf(".")>-1&&s(i.Address,`has a DataType ${i.DataType} but has a decimal point in the number.`)}break;case"float":"number"!=e&&s(i.Address,`has a DataType ${i.DataType} but is of the type ${e}`);break;case"DateTime":"Invalid Date"==new Date(a).toString()&&s(i.Address,`has a DataType ${i.DataType} but is not parsable as a Date by Javascript`);default:"string"!=e&&s(i.Address,`has a DataType ${i.DataType} (which auto-converted to String because it was unrecognized) but is of the type ${e}`)}}}return t}getDefaultValue(e){if(e.hasOwnProperty("Default"))return e.Default;{let t=e.hasOwnProperty("DataType")?e.DataType:"String";return this.options.defaultValues.hasOwnProperty(t)?this.options.defaultValues[t]:null}}populateDefaults(e,t){return this.populateObject(e,t,(e=>e.hasOwnProperty("Default")))}populateObject(e,t,s){let r="object"==typeof e?e:{},i=void 0!==t&&t,a="function"==typeof s?s:e=>!0;return this.elementAddresses.forEach((e=>{let t=this.getDescriptor(e);a(t)&&(!i&&this.checkAddressExists(r,e)||this.setValueAtAddress(r,e,this.getDefaultValue(t)))})),r}}},{"./Manyfest-LogToConsole.js":2,"./Manyfest-ObjectAddressResolver.js":3}]},{},[1])(1)}));
//# sourceMappingURL=manyfest.min.js.map
