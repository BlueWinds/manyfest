!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Fable=e()}}((function(){return function e(t,s,r){function a(i,o){if(!s[i]){if(!t[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(n)return n(i,!0);var h=new Error("Cannot find module '"+i+"'");throw h.code="MODULE_NOT_FOUND",h}var p=s[i]={exports:{}};t[i][0].call(p.exports,(function(e){return a(t[i][1][e]||e)}),p,p.exports,e,t,s,r)}return s[i].exports}for(var n="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
var r=e("./Manyfest.js");"object"==typeof window&&(window.Manyfest=r),t.exports=r},{"./Manyfest.js":7}],2:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r,this.translationTable={}}translationCount(){return Object.keys(this.translationTable).length}addTranslation(e){if("object"!=typeof e)return this.logError("Hash translation addTranslation expected a translation be type object but was passed in "+typeof e),!1;Object.keys(e).forEach((t=>{"string"!=typeof e[t]?this.logError(`Hash translation addTranslation expected a translation destination hash for [${t}] to be a string but the referrant was a ${typeof e[t]}`):this.translationTable[t]=e[t]}))}removeTranslationHash(e){this.translationTable.hasOwnProperty(e)&&delete this.translationTable[e]}removeTranslation(e){if("string"==typeof e)return this.removeTranslationHash(e),!0;if("object"==typeof e){return Object.keys(e).forEach((e=>{this.removeTranslation(e)})),!0}return this.logError("Hash translation removeTranslation expected either a string or an object but the passed-in translation was type "+typeof e),!1}clearTranslations(){this.translationTable={}}translate(e){return this.translationTable.hasOwnProperty(e)?this.translationTable[e]:e}}},{"./Manyfest-LogToConsole.js":3}],3:[function(e,t,s){t.exports=(e,t)=>{let s="string"==typeof e?e:"";console.log(`[Manyfest] ${s}`),t&&console.log(JSON.stringify(t))}},{}],4:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r}generateAddressses(e,t,s){let r="string"==typeof t?t:"",a="object"==typeof s?s:{},n={Address:r,Hash:r,Name:r,InSchema:!1};switch(typeof e){case"string":n.DataType="String",n.Default=e,a[r]=n;break;case"number":case"bigint":n.DataType="Number",n.Default=e,a[r]=n;break;case"undefined":n.DataType="Any",n.Default=e,a[r]=n;break;case"object":if(Array.isArray(e)){n.DataType="Array",""!=r&&(a[r]=n);for(let t=0;t<e.length;t++)this.generateAddressses(e[t],`${r}[${t}]`,a)}else{n.DataType="Object",""!=r&&(a[r]=n,r+=".");let t=Object.keys(e);for(let s=0;s<t.length;s++)this.generateAddressses(e[t[s]],`${r}${t[s]}`,a)}}return a}}},{"./Manyfest-LogToConsole.js":3}],5:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r}cleanWrapCharacters(e,t){return t.startsWith(e)&&t.endsWith(e)?t.substring(1,t.length-1):t}checkAddressExists(e,t){if("object"!=typeof e)return!1;if("string"!=typeof t)return!1;let s=t.indexOf(".");if(-1==s){let s=t.indexOf("["),r=t.indexOf("]");if(s>0&&r>s&&r-s>1){let a=t.substring(0,s).trim();if("object"!=typeof e[a])return!1;let n=t.substring(s+1,r).trim(),i=parseInt(n,10);return Array.isArray(e[a])!=isNaN(i)&&(isNaN(i)?(n=this.cleanWrapCharacters('"',n),n=this.cleanWrapCharacters("`",n),n=this.cleanWrapCharacters("'",n),e[a].hasOwnProperty(n)):i in e[a])}return e.hasOwnProperty(t)}{let r=t.substring(0,s),a=t.substring(s+1),n=r.indexOf("["),i=r.indexOf("]");if(n>0&&i>n&&i-n>1){let t=r.substring(0,n).trim(),s=r.substring(n+1,i).trim(),o=parseInt(s,10);return Array.isArray(e[t])!=isNaN(o)&&(isNaN(o)?(s=this.cleanWrapCharacters('"',s),s=this.cleanWrapCharacters("`",s),s=this.cleanWrapCharacters("'",s),this.checkAddressExists(e[t][s],a)):this.checkAddressExists(e[t][o],a))}return(!e.hasOwnProperty(r)||"object"==typeof e[r])&&(e.hasOwnProperty(r)||(e[r]={}),this.checkAddressExists(e[r],a))}}getValueAtAddress(e,t,s){if("object"!=typeof e)return;if("string"!=typeof t)return;let r="";"string"==typeof s&&(r=s);let a=t.indexOf(".");if(-1==a){let s=t.indexOf("["),r=t.indexOf("]"),a=t.indexOf("{}");if(s>0&&r>s&&r-s>1){let a=t.substring(0,s).trim();if("object"!=typeof e[a])return;let n=t.substring(s+1,r).trim(),i=parseInt(n,10);if(Array.isArray(e[a])==isNaN(i))return;return isNaN(i)?(n=this.cleanWrapCharacters('"',n),n=this.cleanWrapCharacters("`",n),n=this.cleanWrapCharacters("'",n),e[a][n]):e[a][i]}if(s>0&&r>s&&r-s==1){let r=t.substring(0,s).trim();return!!Array.isArray(e[r])&&e[r]}if(a>0){let s=t.substring(0,a).trim();return"object"==typeof e[s]&&e[s]}return e[t]}{let s=t.substring(0,a),n=t.substring(a+1),i=s.indexOf("["),o=s.indexOf("]");if(i>0&&o>i&&o-i>1){let t=s.substring(0,i).trim(),a=s.substring(i+1,o).trim(),l=parseInt(a,10);if(Array.isArray(e[t])==isNaN(l))return;return isNaN(l)?(a=this.cleanWrapCharacters('"',a),a=this.cleanWrapCharacters("`",a),a=this.cleanWrapCharacters("'",a),r=`${r}${r.length>0?".":""}${s}`,this.getValueAtAddress(e[t][a],n,r)):(r=`${r}${r.length>0?".":""}${s}`,this.getValueAtAddress(e[t][l],n,r))}if(i>0&&o>i&&o-i==1){let s=t.substring(0,i).trim();if(!Array.isArray(e[s]))return!1;let a=e[s];r=`${r}${r.length>0?".":""}${s}`;let o={};for(let t=0;t<a.length;t++){let a=`${r}[${t}]`,i=this.getValueAtAddress(e[s][t],n,a);o[`${a}.${n}`]=i}return o}let l=t.indexOf("{}");if(l>0){let s=t.substring(0,l).trim();if("object"!=typeof e[s])return!1;let a=e[s],i=Object.keys(a);r=`${r}${r.length>0?".":""}${s}`;let o={};for(let t=0;t<i.length;t++){let a=`${r}.${i[t]}`,l=this.getValueAtAddress(e[s][i[t]],n,a);o[`${a}.${n}`]=l}return o}return e.hasOwnProperty(s)&&"object"!=typeof e[s]?void 0:e.hasOwnProperty(s)?(r=`${r}${r.length>0?".":""}${s}`,this.getValueAtAddress(e[s],n,r)):(r=`${r}${r.length>0?".":""}${s}`,e[s]={},this.getValueAtAddress(e[s],n,r))}}setValueAtAddress(e,t,s){if("object"!=typeof e)return!1;if("string"!=typeof t)return!1;let r=t.indexOf(".");if(-1==r){let r=t.indexOf("["),a=t.indexOf("]");if(r>0&&a>r&&a-r>1){let n=t.substring(0,r).trim();if("object"!=typeof e[n])return!1;let i=t.substring(r+1,a).trim(),o=parseInt(i,10);return Array.isArray(e[n])!=isNaN(o)&&(isNaN(o)?(i=this.cleanWrapCharacters('"',i),i=this.cleanWrapCharacters("`",i),i=this.cleanWrapCharacters("'",i),e[n][i]=s,!0):(e[n][o]=s,!0))}return e[t]=s,!0}{let a=t.substring(0,r),n=t.substring(r+1),i=a.indexOf("["),o=a.indexOf("]");if(i>0&&o>i&&o-i>1){let t=a.substring(0,i).trim(),r=a.substring(i+1,o).trim(),l=parseInt(r,10);return Array.isArray(e[t])!=isNaN(l)&&(isNaN(l)?(r=this.cleanWrapCharacters('"',r),r=this.cleanWrapCharacters("`",r),r=this.cleanWrapCharacters("'",r),this.setValueAtAddress(e[t][r],n,s)):this.setValueAtAddress(e[t][l],n,s))}return e.hasOwnProperty(a)&&"object"!=typeof e[a]?(e.hasOwnProperty("__ERROR")||(e.__ERROR={}),e.__ERROR[t]=s,!1):(e.hasOwnProperty(a)||(e[a]={}),this.setValueAtAddress(e[a],n,s))}}}},{"./Manyfest-LogToConsole.js":3}],6:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js");t.exports=class{constructor(e,t){this.logInfo="function"==typeof e?e:r,this.logError="function"==typeof t?t:r}resolveAddressMappings(e,t){if("object"!=typeof e)return this.logError("Attempted to resolve address mapping but the descriptor was not an object."),!1;if("object"!=typeof t)return!0;let s=Object.keys(e),r={};return s.forEach((t=>{e[t].hasOwnProperty("Hash")&&(r[e[t].Hash]=t)})),Object.keys(t).forEach((s=>{let a=t[s],n=!1,i=!1;e.hasOwnProperty(s)?n=s:r.hasOwnProperty(s)&&(n=r[s]),n?(i=e[n],delete e[n]):i={Hash:s},e[a]=i})),!0}safeResolveAddressMappings(e,t){let s=JSON.parse(JSON.stringify(e));return this.resolveAddressMappings(s,t),s}mergeAddressMappings(e,t){if("object"!=typeof t||"object"!=typeof e)return this.logError("Attempted to merge two schema descriptors but both were not objects."),!1;let s=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e));return Object.keys(s).forEach((e=>{r.hasOwnProperty(e)||(r[e]=s[e])})),r}}},{"./Manyfest-LogToConsole.js":3}],7:[function(e,t,s){
/**
* @license MIT
* @author <steven@velozo.com>
*/
let r=e("./Manyfest-LogToConsole.js"),a=e("./Manyfest-HashTranslation.js"),n=e("./Manyfest-ObjectAddressResolver.js"),i=e("./Manyfest-ObjectAddressGeneration.js"),o=e("./Manyfest-SchemaManipulation.js");class l{constructor(e,t,s,l){this.logInfo="function"==typeof t?t:r,this.logError="function"==typeof s?s:r,this.objectAddressResolver=new n(this.logInfo,this.logError),this.options={strict:!1,defaultValues:{String:"",Number:0,Float:0,Integer:0,Boolean:!1,Binary:0,DateTime:0,Array:[],Object:{},Null:null}},this.scope=void 0,this.elementAddresses=void 0,this.elementHashes=void 0,this.elementDescriptors=void 0,this.reset(),"object"==typeof e&&this.loadManifest(e),this.schemaManipulations=new o(this.logInfo,this.logError),this.objectAddressGeneration=new i(this.logInfo,this.logError),this.hashTranslations=new a(this.logInfo,this.logError)}reset(){this.scope="DEFAULT",this.elementAddresses=[],this.elementHashes={},this.elementDescriptors={}}clone(){let e=JSON.parse(JSON.stringify(this.options)),t=new l(this.getManifest(),this.logInfo,this.logError,e);return t.hashTranslations.addTranslation(this.hashTranslations.translationTable),t}deserialize(e){return this.loadManifest(JSON.parse(e))}loadManifest(e){if("object"!=typeof e)return this.logError(`(${this.scope}) Error loading manifest; expecting an object but parameter was type ${typeof e}.`),!1;if(e.hasOwnProperty("Scope")?"string"==typeof e.Scope?this.scope=e.Scope:this.logError(`(${this.scope}) Error loading scope from manifest; expecting a string but property was type ${typeof e.Scope}.`,e):this.logError(`(${this.scope}) Error loading scope from manifest object.  Property "Scope" does not exist in the root of the object.`,e),e.hasOwnProperty("Descriptors"))if("object"==typeof e.Descriptors){let t=Object.keys(e.Descriptors);for(let s=0;s<t.length;s++)this.addDescriptor(t[s],e.Descriptors[t[s]])}else this.logError(`(${this.scope}) Error loading description object from manifest object.  Expecting an object in 'Manifest.Descriptors' but the property was type ${typeof e.Descriptors}.`,e);else this.logError(`(${this.scope}) Error loading object description from manifest object.  Property "Descriptors" does not exist in the root of the Manifest object.`,e)}serialize(){return JSON.stringify(this.getManifest())}getManifest(){return{Scope:this.scope,Descriptors:JSON.parse(JSON.stringify(this.elementDescriptors))}}addDescriptor(e,t){return"object"==typeof t?(t.hasOwnProperty("Address")||(t.Address=e),this.elementDescriptors.hasOwnProperty(e)||this.elementAddresses.push(e),this.elementDescriptors[e]=t,this.elementHashes[e]=e,t.hasOwnProperty("Hash")?this.elementHashes[t.Hash]=e:t.Hash=e,!0):(this.logError(`(${this.scope}) Error loading object descriptor for address '${e}' from manifest object.  Expecting an object but property was type ${typeof t}.`),!1)}getDescriptorByHash(e){return this.getDescriptor(this.resolveHashAddress(e))}getDescriptor(e){return this.elementDescriptors[e]}checkAddressExistsByHash(e,t){return this.checkAddressExists(e,this.resolveHashAddress(t))}checkAddressExists(e,t){return this.objectAddressResolver.checkAddressExists(e,t)}resolveHashAddress(e){let t,s=this.elementHashes.hasOwnProperty(e),r=this.hashTranslations.translationTable.hasOwnProperty(e);return t=s&&!r?this.elementHashes[e]:r&&this.elementHashes.hasOwnProperty(this.hashTranslations.translate(e))?this.elementHashes[this.hashTranslations.translate(e)]:r?this.hashTranslations.translate(e):e,t}getValueByHash(e,t){let s=this.getValueAtAddress(e,this.resolveHashAddress(t));return void 0===s&&(s=this.getDefaultValue(this.getDescriptorByHash(t))),s}getValueAtAddress(e,t){let s=this.objectAddressResolver.getValueAtAddress(e,t);return void 0===s&&(s=this.getDefaultValue(this.getDescriptor(t))),s}setValueByHash(e,t,s){return this.setValueAtAddress(e,this.resolveHashAddress(t),s)}setValueAtAddress(e,t,s){return this.objectAddressResolver.setValueAtAddress(e,t,s)}validate(e){let t={Error:null,Errors:[],MissingElements:[]};"object"!=typeof e&&(t.Error=!0,t.Errors.push("Expected passed in object to be type object but was passed in "+typeof e));let s=(e,s)=>{t.Error=!0,t.Errors.push(`Element at address "${e}" ${s}.`)};for(let r=0;r<this.elementAddresses.length;r++){let a=this.getDescriptor(this.elementAddresses[r]),n=this.checkAddressExists(e,a.Address),i=this.getValueAtAddress(e,a.Address);if(void 0!==i&&n||(t.MissingElements.push(a.Address),(a.Required||this.options.strict)&&s(a.Address,"is flagged REQUIRED but is not set in the object")),a.DataType){let e=typeof i;switch(a.DataType.toString().trim().toLowerCase()){case"string":"string"!=e&&s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);break;case"number":"number"!=e&&s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);break;case"integer":if("number"!=e)s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);else{i.toString().indexOf(".")>-1&&s(a.Address,`has a DataType ${a.DataType} but has a decimal point in the number.`)}break;case"float":"number"!=e&&s(a.Address,`has a DataType ${a.DataType} but is of the type ${e}`);break;case"DateTime":"Invalid Date"==new Date(i).toString()&&s(a.Address,`has a DataType ${a.DataType} but is not parsable as a Date by Javascript`);default:"string"!=e&&s(a.Address,`has a DataType ${a.DataType} (which auto-converted to String because it was unrecognized) but is of the type ${e}`)}}}return t}getDefaultValue(e){if("object"==typeof e){if(e.hasOwnProperty("Default"))return e.Default;{let t=e.hasOwnProperty("DataType")?e.DataType:"String";return this.options.defaultValues.hasOwnProperty(t)?this.options.defaultValues[t]:null}}}populateDefaults(e,t){return this.populateObject(e,t,(e=>e.hasOwnProperty("Default")))}populateObject(e,t,s){let r="object"==typeof e?e:{},a=void 0!==t&&t,n="function"==typeof s?s:e=>!0;return this.elementAddresses.forEach((e=>{let t=this.getDescriptor(e);n(t)&&(!a&&this.checkAddressExists(r,e)||this.setValueAtAddress(r,e,this.getDefaultValue(t)))})),r}}t.exports=l},{"./Manyfest-HashTranslation.js":2,"./Manyfest-LogToConsole.js":3,"./Manyfest-ObjectAddressGeneration.js":4,"./Manyfest-ObjectAddressResolver.js":5,"./Manyfest-SchemaManipulation.js":6}]},{},[1])(1)}));
//# sourceMappingURL=manyfest.min.js.map
